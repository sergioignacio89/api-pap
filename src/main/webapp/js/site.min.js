function ValidateSize(e){e.files[0].size/1024/1024>2.5&&($("#modalStyle").removeClass("modal-notify modal-danger"),$("#modalStyle").addClass("modal-notify modal-warning"),$("#titleModal").html("Atención"),$("#bodyModal").html("El tamaño del archivo es demasiado grande, máximo tamaño posible: 2.5 MB"),$("#alertModal").modal())}function FileValidation(){var e=$("#inputGroupFile01"),a=e[0].value;if(!/(\.xls|\.xlsx)$/i.exec(a))return $("#modalStyle").removeClass("modal-notify modal-danger"),$("#modalStyle").addClass("modal-notify modal-warning"),$("#titleModal").html("Atención"),$("#bodyModal").html("Solo se permiten archivos con la siguiente extension: .xls/.xlsx"),$("#alertModal").modal(),e.value="",!1;Predict()}function Predict(){document.getElementById("loader").style.display="block";var e=new FormData;jQuery.each(jQuery("#inputGroupFile01")[0].files,function(a,t){e.append("file",t)}),jQuery.ajax({url:"rest/accidents/predict/",data:e,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(e){var a=TransformarJSON(e);$("#rowGrid").css("visibility","visible"),document.getElementById("loader").style.display="none",ArmarTable(a),ArmarPieChart(a),$('[data-toggle="tooltip"]').tooltip()},error:function(e){document.getElementById("loader").style.display="none",$("#modalStyle").removeClass("modal-notify modal-warning"),$("#modalStyle").addClass("modal-notify modal-danger"),$("#titleModal").html("Error"),$("#bodyModal").html(e.responseJSON.friendlyError),$("#alertModal").modal()}})}function ArmarTable(e){$("#dtBasic").DataTable({data:e,destroy:!0,columns:[{data:"id"},{data:"siniestroSeveridad"},{data:"siniestradoDescUltimoDX"},{data:"siniestroParteCuerpo"},{data:"siniestroPrestador"},{data:"siniestroCaseSML"},{data:"siniestroPorcentajeJuicio"}],columnDefs:[{targets:2,render:function(e,a,t){return"display"===a&&null!=e&&(e=e.replace(/<(?:.|\\n)*?>/gm,"")).length>80?'<span class="show-ellipsis" data-toggle="tooltip" data-placement="bottom" title="'+e+'">'+e.substr(0,80)+'</span><span class="no-show">'+e.substr(80)+"</span>":e}},{targets:[6]}],dom:"<'row buttonrows'<'col-sm-3'l><'col-sm-6 text-center'B><'col-sm-3'f>><'row'<'col-sm-12'tr>><'row'<'col-sm-5'i><'col-sm-7'p>>",buttons:[{extend:"excel",text:'<span data-toggle="tooltip" data-placement="bottom" title="EXPORTAR RESULTADOS">EXPORTAR RESULTADOS </span><span class="fa fa-download"></span>'}],language:{info:"Mostrando _START_ a _END_ de _TOTAL_ Registros",search:"Buscar",lengthMenu:"Mostrar _MENU_ registros",infoEmpty:"Mostrando 0 a 0 de 0 registros",emptyTable:"No hay registros en la tabla",zeroRecords:"No se encontraron los registros buscados",paginate:{first:"«",previous:"‹",next:"›",last:"»"},aria:{paginate:{first:"Primero",previous:"Anterior",next:"Siguiente",last:"Último"}}},order:[6,"desc"],createdRow:function(e,a,t){parseFloat(a.siniestroPorcentajeJuicio)<=lowMaxRange?$(e).addClass("rowGood"):parseFloat(a.siniestroPorcentajeJuicio)>MediumMinRange&&parseFloat(a.siniestroPorcentajeJuicio)<MediumMaxRange?$(e).addClass("rowWarning"):$(e).addClass("rowDanger")}}),$(".dataTables_length").addClass("bs-select")}function ArmarPieChart(e){for(var a=[0,0,0],t=0;t<e.length;t++)parseFloat(e[t].siniestroPorcentajeJuicio)<=lowMaxRange?a[2]++:parseFloat(e[t].siniestroPorcentajeJuicio)>MediumMinRange&&parseFloat(e[t].siniestroPorcentajeJuicio)<MediumMaxRange?a[1]++:a[0]++;var o=document.getElementById("myChart"),i={labels:[captionHigh,captionMedium,captionLow],datasets:[{data:a,backgroundColor:["#e86c2e","#e2bf50","#026937"]}]};void 0==s&&null==s||s.destroy();var s=new Chart(o,{type:"pie",data:i})}function TransformarJSON(e){for(var a=[],t=0;t<e.accidents.length;t++){var o={id:"",siniestroSeveridad:"",siniestradoDescUltimoDX:"",siniestroParteCuerpo:"",siniestroPorcentajeJuicio:"",siniestroPrestador:"",siniestroCaseSML:""};o.id=e.accidents[t].accident.id,o.siniestradoDescUltimoDX=e.accidents[t].accident.siniestradoDescUltimoDX,o.siniestroParteCuerpo=e.accidents[t].accident.siniestroParteCuerpo,o.siniestroSeveridad=e.accidents[t].accident.siniestroSeveridad,o.siniestroPorcentajeJuicio=Math.round(parseFloat(e.accidents[t].inferredValue))+"%",o.siniestroPrestador=e.accidents[t].accident.siniestroPrestador,o.siniestroCaseSML=e.accidents[t].accident.siniestroCaseSML,a.push(o)}return lowMinRange=e.ranges.low.min,lowMaxRange=e.ranges.low.max,captionLow=e.ranges.low.caption,MediumMinRange=e.ranges.middle.min,MediumMaxRange=e.ranges.middle.max,captionMedium=e.ranges.middle.caption,HighMinRangeMinRange=e.ranges.critical.min,HighMaxRangeMaxRange=e.ranges.critical.max,captionHigh=e.ranges.critical.caption,a}$(document).ready(function(){$("#rowGrid").css("visibility","hidden"),document.getElementById("loader").style.display="none",$('[data-toggle="tooltip"]').tooltip()});